---
id: Uto-9022
status: closed
deps: []
links: []
created: 2026-02-26T13:17:12Z
type: task
priority: 2
tags: [testing, kingdom-news, parser, uniques]
---
# Kingdom News tests: unique attack count assertions

Add focused test cases for the unique attack calculation to guard against regressions in the sliding-window algorithm. The correct algorithm uses UNIQUE_WINDOW_DAYS=6 with the > operator (new window starts when date > windowStart + 6, i.e. on the 7th in-game day).

## Acceptance Criteria

- Unit-test calculateUniques() directly with known date sequences:
  - Same-day attacks → 1 unique
  - Attacks exactly 6 days apart → 1 unique (within window)
  - Attacks exactly 7 days apart → 2 uniques (new window)
  - Attacks spanning multiple windows
- Integration test: assert per-province unique counts for key provinces in the kingdom news test data (e.g. 19-Alchemaria=4, 10-Longtimeago=5, 12-Misstress=6, 23-Blitzwaaagh=5)
- Assert made/suffered unique totals match target values (105 made, 82 suffered)

